# ============================================
# 多无人机协同目标状态估计器参数配置
# 对应节点: multi_uav_target_estimator_node
# 命名空间: ~ (私有参数)
# ============================================

# ========== 基本参数 ==========
num_drones: 4           # 无人机数量，对应 /drone_0_target ... /drone_(N-1)_target
window_size: 20         # 滑动窗口大小 N (时间序列长度)
buffer_size: 25         # 每架无人机保留的观测个数上限
publish_rate: 20.0      # 发布频率 (Hz)，定时器触发优化的频率

# 如果你在其他地方需要 dt，可以写在这里，但当前 C++ 没读取这个参数
dt: 0.1                 # 时间步长 (秒) —— 目前代码未使用，只作为注释

# ========== 观测噪声模拟(可选) ==========
noise_std_x: 0.0        # 用于在接收的观测上添加模拟噪声(米)
noise_std_y: 0.0
noise_std_z: 0.0
# 如果想测试鲁棒性，可以改为 0.05 之类的小值

# ========== 优化 / 噪声模型参数 ==========
lambda_mot: 1.0         # 运动平滑约束权重 λ_mot (二阶平滑项)
                        # 越大轨迹越平滑，可能带来滞后
                        # 建议范围: 0.1 ~ 10.0

huber_delta: 1.0        # Huber 鲁棒核阈值 δ
                        # 越小，对离群点越敏感
                        # 0 或负数表示不用 Huber (代码中：<=0 就不加)

measurement_noise_std: 0.1   # 传感器(观测)噪声标准差 (米)
                             # 数值越小 = 认为观测越准，观测约束越“硬”
motion_noise_std: 0.1        # 运动模型噪声标准差 (米)
                             # 数值越小 = 越相信“平滑运动”(恒速度)，轨迹更平滑

enable_verbose: false   # 是否输出 Ceres 详细优化信息
                        # true : 在终端打印每次迭代细节
                        # false: 只打印关键信息

# ========== 权重参数(与旧版兼容) ==========
prior_weight: 10.0                   # 先验约束权重(对第一个状态)
observation_weight: 10.0             # 观测约束基础权重
relative_motion_base_weight: 100.0   # 相对运动约束基础权重
relative_motion_max_gap: 3           # 相对运动约束最大时间间隔(节点索引间距)

# 调整建议:
# 1. 估计结果震荡:
#    - 增大 lambda_mot (1.0 -> 5.0)
#    - 或增大 motion_noise_std (放松对平滑的强约束，结合整体效果调)
#
# 2. 对异常测量不够鲁棒:
#    - 减小 huber_delta (例如: 1.0 -> 0.5)
#
# 3. 估计滞后太明显:
#    - 减小 window_size (例如: 20 -> 10)
#    - 适当增大 measurement_noise_std (降低单次观测的权重)
#    - 或减小 lambda_mot
#
# 4. 估计不够平滑:
#    - 增大 lambda_mot
#    - 减小 motion_noise_std (增大运动平滑约束权重)
#
# ============================================
